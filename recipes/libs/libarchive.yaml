inherit: [autotools]

metaEnvironment:
    PKG_VERSION: "3.8.5"
    PKG_LICENSE: "LicenseRef-libarchive"
    PKG_LICENSE_PATH: |
        libarchive:COPYING

depends:
    - libs::zlib-dev

    - use: []
      depends:
          - libs::zlib-tgt

checkoutSCM:
    scm: url
    url: https://www.libarchive.de/downloads/libarchive-${PKG_VERSION}.tar.xz
    digestSHA256: d68068e74beee3a0ec0dd04aee9037d5757fcc651591a6dcf1b6d542fb15a703
    stripComponents: 1

buildScript: |
    autotoolsBuild "$1" \
        --disable-bsdtar \
        --disable-bsdcpio \
        --disable-bsdcat \
        --disable-acl \
        --disable-xattr \
        --without-bz2lib \
        --without-expat \
        --without-libiconv-prefix \
        --without-xml2 \
        --without-lz4 \
        --without-lzo2 \
        --without-mbedtls \
        --without-nettle \
        --without-openssl \
        --with-zlib \
        --without-lzma \
        --without-zstd

multiPackage:
    dev:
        packageScript: autotoolsPackageDev
        provideDeps: ["*-dev"]

    tgt:
        packageScript: autotoolsPackageTgt
        provideDeps: ["*-tgt"]
