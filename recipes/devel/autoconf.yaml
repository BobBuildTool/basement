inherit: [autotools-noarch, patch]

metaEnvironment:
    PKG_VERSION: "2.71"

checkoutSCM:
    scm: url
    url: ${GNU_MIRROR}/autoconf/autoconf-${PKG_VERSION}.tar.xz
    digestSHA256: "f14c83cfebcc9427f2c3cea7258bd90df972d92eb26752da4ddad81c87a0faa4"
    stripComponents: 1

checkoutDeterministic: True
checkoutScript: |
    patchApplySeries $<<autoconf/*.patch>>

buildScript: |
    export EMACS="no"
    export ac_cv_path_M4=m4
    export ac_cv_prog_gnu_m4_gnu=no
    autotoolsNoarchBuild $1

packageScript: |
    autotoolsNoarchPackageTgt
    # make result deterministic
    sed -i -e '/Generated from/d' usr/bin/*
    find -name '*.m4f' -delete
    sed -i -e 's/Generated from __file__/Generated/' \
        usr/share/autoconf/m4sugar/m4sh.m4
