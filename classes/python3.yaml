buildTools: [python3]
buildScript: |
    PYTHONDESTLIB=$(python3 -c "import sysconfig; print(sysconfig.get_config_var('DESTLIB'))")
    if [[ "$PYTHONDESTLIB" == "None" ]] ; then
        PYTHONDESTLIB="/usr/lib"
    fi
    export PYTHONDESTLIB
    export PYTHONVERSION=$(python3 -c "import sysconfig; print(sysconfig.get_config_var('py_version_short'))")

    for i in "${!BOB_ALL_PATHS[@]}" ; do
        if [[ $i != *-tgt ]] ; then
            PREFIX="${BOB_ALL_PATHS[$i]}$PYTHONDESTLIB"
            for j in "" "lib-dynload" "site-packages" ; do
                PYTHONPATH="${PYTHONPATH:+$PYTHONPATH:}$PREFIX${j:+/$j}"
            done
        fi
    done
    export PYTHONPATH

    pipInstall()
    {
        # force lib instead of Lib for MSYS
        mkdir -p install/usr/lib
        python3 -m pip install -q $* \
            --root ${PWD}/install \
            --prefix usr \
            --disable-pip-version-check \
            --no-warn-script-location \
            --ignore-installed
    }

packageScript: |
    BUILD_DIR=$1

    installPythonModule()
    {
        rsync -aH --exclude "__pycache__/" --exclude "*.dist-info/" --exclude "*.egg-info" $@ "$BUILD_DIR/install/" .
    }
